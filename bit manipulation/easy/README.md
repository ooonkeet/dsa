This need to be changed.
Touching bit manipulation after years.
